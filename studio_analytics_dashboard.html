<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics - The Studio - Sleeks</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background: #0a0a0a;
            color: #fff;
            line-height: 1.6;
        }

        .studio-header {
            background: rgba(0,0,0,0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid #222;
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .studio-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 300;
            font-style: italic;
            color: #ff3333;
        }

        .studio-badge {
            background: rgba(255, 51, 51, 0.1);
            border: 1px solid #ff3333;
            padding: 4px 12px;
            font-size: 10px;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: #ff3333;
        }

        .analytics-badge {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #0f0;
            padding: 4px 12px;
            font-size: 10px;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: #0f0;
        }

        .header-controls {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .time-filter {
            background: transparent;
            border: 1px solid #333;
            color: #fff;
            padding: 8px 16px;
            font-size: 12px;
            cursor: pointer;
        }

        .time-filter.active {
            border-color: #ff3333;
            color: #ff3333;
        }

        .main-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px;
        }

        .analytics-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .analytics-title {
            font-size: 48px;
            font-weight: 300;
            margin-bottom: 15px;
        }

        .analytics-subtitle {
            font-size: 18px;
            opacity: 0.7;
            margin-bottom: 30px;
        }

        .last-updated {
            font-size: 12px;
            color: #0f0;
            font-family: 'Courier New', monospace;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 60px;
        }

        .kpi-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid #222;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: #ff3333;
        }

        .kpi-card.growth::before {
            background: #0f0;
        }

        .kpi-card.warning::before {
            background: #ffa500;
        }

        .kpi-value {
            font-size: 42px;
            font-weight: 300;
            color: #ff3333;
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }

        .kpi-value.growth {
            color: #0f0;
        }

        .kpi-value.warning {
            color: #ffa500;
        }

        .kpi-label {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            opacity: 0.8;
        }

        .kpi-change {
            font-size: 12px;
            opacity: 0.6;
        }

        .kpi-change.positive {
            color: #0f0;
        }

        .kpi-change.negative {
            color: #ff3333;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
            margin-bottom: 60px;
        }

        .main-charts {
            display: grid;
            gap: 40px;
        }

        .sidebar-metrics {
            display: grid;
            gap: 30px;
        }

        .chart-section {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid #222;
        }

        .chart-header {
            padding: 25px 30px;
            border-bottom: 1px solid #222;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chart-title {
            font-size: 20px;
            font-weight: 300;
        }

        .chart-filter {
            background: transparent;
            border: 1px solid #333;
            color: #fff;
            padding: 6px 12px;
            font-size: 11px;
            cursor: pointer;
        }

        .chart-content {
            padding: 30px;
            height: 300px;
            position: relative;
        }

        .chart-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 51, 51, 0.1) 0%, rgba(0, 0, 0, 0.3) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px dashed #333;
            font-size: 14px;
            opacity: 0.6;
        }

        .revenue-chart {
            background: linear-gradient(to right, #ff3333, #cc0000);
            height: 200px;
            position: relative;
            margin-bottom: 20px;
        }

        .growth-indicators {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .indicator {
            text-align: center;
            padding: 15px;
            background: rgba(0,0,0,0.3);
        }

        .indicator-value {
            font-size: 24px;
            font-weight: 300;
            color: #0f0;
        }

        .indicator-label {
            font-size: 11px;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .dealer-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .dealer-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #222;
        }

        .dealer-info {
            flex: 1;
        }

        .dealer-name {
            font-size: 16px;
            margin-bottom: 3px;
        }

        .dealer-location {
            font-size: 12px;
            opacity: 0.6;
        }

        .dealer-stats {
            text-align: right;
        }

        .dealer-revenue {
            font-size: 16px;
            color: #ff3333;
            margin-bottom: 3px;
        }

        .dealer-orders {
            font-size: 12px;
            opacity: 0.6;
        }

        .product-performance {
            display: grid;
            gap: 15px;
        }

        .product-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-left: 3px solid #ff3333;
        }

        .product-item.top::after {
            content: '🔥';
            margin-left: 10px;
        }

        .product-name {
            font-size: 14px;
            font-weight: 500;
        }

        .product-metrics {
            text-align: right;
        }

        .product-units {
            font-size: 14px;
            color: #ff3333;
        }

        .product-revenue {
            font-size: 12px;
            opacity: 0.6;
        }

        .geographic-heat {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .city-bubble {
            background: rgba(255, 51, 51, 0.1);
            border: 1px solid #ff3333;
            padding: 20px;
            text-align: center;
            border-radius: 50%;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .city-bubble.hot {
            background: rgba(255, 51, 51, 0.3);
            animation: pulse 2s infinite;
        }

        .city-name {
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .city-orders {
            font-size: 16px;
            color: #ff3333;
        }

        .insights-feed {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid #222;
            max-height: 500px;
            overflow-y: auto;
        }

        .insight-item {
            padding: 20px;
            border-bottom: 1px solid #222;
            display: flex;
            gap: 15px;
        }

        .insight-icon {
            width: 32px;
            height: 32px;
            background: #ff3333;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #000;
            flex-shrink: 0;
        }

        .insight-content {
            flex: 1;
        }

        .insight-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .insight-description {
            font-size: 12px;
            opacity: 0.7;
            line-height: 1.4;
        }

        .insight-time {
            font-size: 11px;
            opacity: 0.5;
            margin-top: 8px;
        }

        .cohort-analysis {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-top: 20px;
        }

        .cohort-cell {
            aspect-ratio: 1;
            background: rgba(255, 51, 51, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            border: 1px solid #333;
        }

        .cohort-cell.high {
            background: rgba(255, 51, 51, 0.8);
            color: #000;
        }

        .cohort-cell.medium {
            background: rgba(255, 51, 51, 0.4);
        }

        .cohort-cell.low {
            background: rgba(255, 51, 51, 0.1);
        }

        .export-controls {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .export-btn {
            background: transparent;
            border: 1px solid #ff3333;
            color: #ff3333;
            padding: 10px 20px;
            font-size: 12px;
            letter-spacing: 1px;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            background: #ff3333;
            color: #000;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 0.8;
            }
            50% {
                transform: scale(1.05);
                opacity: 1;
            }
        }

        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .kpi-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            .kpi-grid {
                grid-template-columns: 1fr;
            }
            
            .geographic-heat {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Studio Header -->
    <header class="studio-header">
        <div class="header-content">
            <div class="studio-logo">
                <div class="logo-text">Sleeks</div>
                <div class="studio-badge">Studio</div>
                <div class="analytics-badge">Analytics</div>
            </div>
            
            <div class="header-controls">
                <button class="time-filter active">7D</button>
                <button class="time-filter">30D</button>
                <button class="time-filter">90D</button>
                <button class="time-filter">1Y</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Analytics Header -->
        <section class="analytics-header">
            <h1 class="analytics-title">Studio Intelligence</h1>
            <p class="analytics-subtitle">Real-time insights for the Sleeks ecosystem</p>
            <div class="last-updated">Last updated: 2 minutes ago • Live data</div>
        </section>

        <!-- KPI Grid -->
        <section class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-value">R847K</div>
                <div class="kpi-label">Total Revenue</div>
                <div class="kpi-change positive">+23% vs last period</div>
            </div>

            <div class="kpi-card growth">
                <div class="kpi-value growth">47</div>
                <div class="kpi-label">Active Studio Members</div>
                <div class="kpi-change positive">+8 new this week</div>
            </div>

            <div class="kpi-card">
                <div class="kpi-value">R18,063</div>
                <div class="kpi-label">Avg Order Value</div>
                <div class="kpi-change positive">+12% vs last period</div>
            </div>

            <div class="kpi-card growth">
                <div class="kpi-value growth">73%</div>
                <div class="kpi-label">Repeat Order Rate</div>
                <div class="kpi-change positive">+5% vs last period</div>
            </div>

            <div class="kpi-card">
                <div class="kpi-value">2.3</div>
                <div class="kpi-label">Orders per Month</div>
                <div class="kpi-change positive">+0.4 vs last period</div>
            </div>

            <div class="kpi-card warning">
                <div class="kpi-value warning">94%</div>
                <div class="kpi-label">Delivery Success Rate</div>
                <div class="kpi-change negative">-2% vs last period</div>
            </div>
        </section>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Main Charts -->
            <div class="main-charts">
                <!-- Revenue Trends -->
                <div class="chart-section">
                    <div class="chart-header">
                        <h2 class="chart-title">Revenue Trends</h2>
                        <select class="chart-filter">
                            <option>All Products</option>
                            <option>Venture Box</option>
                            <option>King Size</option>
                            <option>Club Kits</option>
                        </select>
                    </div>
                    <div class="chart-content">
                        <div class="revenue-chart"></div>
                        <div class="growth-indicators">
                            <div class="indicator">
                                <div class="indicator-value">+23%</div>
                                <div class="indicator-label">Weekly Growth</div>
                            </div>
                            <div class="indicator">
                                <div class="indicator-value">R121K</div>
                                <div class="indicator-label">This Week</div>
                            </div>
                            <div class="indicator">
                                <div class="indicator-value">R98K</div>
                                <div class="indicator-label">Last Week</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Geographic Distribution -->
                <div class="chart-section">
                    <div class="chart-header">
                        <h2 class="chart-title">Geographic Heat Map</h2>
                        <select class="chart-filter">
                            <option>Orders</option>
                            <option>Revenue</option>
                            <option>New Members</option>
                        </select>
                    </div>
                    <div class="chart-content">
                        <div class="geographic-heat">
                            <div class="city-bubble hot">
                                <div class="city-name">Cape Town</div>
                                <div class="city-orders">23</div>
                            </div>
                            <div class="city-bubble">
                                <div class="city-name">Johannesburg</div>
                                <div class="city-orders">18</div>
                            </div>
                            <div class="city-bubble">
                                <div class="city-name">Durban</div>
                                <div class="city-orders">12</div>
                            </div>
                            <div class="city-bubble">
                                <div class="city-name">Pretoria</div>
                                <div class="city-orders">8</div>
                            </div>
                            <div class="city-bubble">
                                <div class="city-name">Stellenbosch</div>
                                <div class="city-orders">6</div>
                            </div>
                            <div class="city-bubble">
                                <div class="city-name">Port Elizabeth</div>
                                <div class="city-orders">4</div>
                            </div>
                        </div>
                        <p style="font-size: 12px; opacity: 0.6; text-align: center;">
                            Cape Town leads with 32% of total orders • Strong growth in Durban (+40%)
                        </p>
                    </div>
                </div>

                <!-- Cohort Analysis -->
                <div class="chart-section">
                    <div class="chart-header">
                        <h2 class="chart-title">Studio Member Retention</h2>
                        <select class="chart-filter">
                            <option>Monthly Cohorts</option>
                            <option>Weekly Cohorts</option>
                        </select>
                    </div>
                    <div class="chart-content">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 11px; opacity: 0.6;">
                            <span>Week 0</span>
                            <span>Week 1</span>
                            <span>Week 2</span>
                            <span>Week 3</span>
                            <span>Week 4</span>
                            <span>Week 5</span>
                            <span>Week 6</span>
                        </div>
                        <div class="cohort-analysis">
                            <div class="cohort-cell high">100%</div>
                            <div class="cohort-cell high">85%</div>
                            <div class="cohort-cell high">73%</div>
                            <div class="cohort-cell medium">62%</div>
                            <div class="cohort-cell medium">58%</div>
                            <div class="cohort-cell medium">54%</div>
                            <div class="cohort-cell medium">51%</div>
                            
                            <div class="cohort-cell high">100%</div>
                            <div class="cohort-cell high">89%</div>
                            <div class="cohort-cell high">76%</div>
                            <div class="cohort-cell medium">68%</div>
                            <div class="cohort-cell medium">65%</div>
                            <div class="cohort-cell medium">61%</div>
                            <div class="cohort-cell">-</div>
                            
                            <div class="cohort-cell high">100%</div>
                            <div class="cohort-cell high">92%</div>
                            <div class="cohort-cell high">81%</div>
                            <div class="cohort-cell high">74%</div>
                            <div class="cohort-cell medium">69%</div>
                            <div class="cohort-cell">-</div>
                            <div class="cohort-cell">-</div>
                        </div>
                        <p style="font-size: 12px; opacity: 0.6; margin-top: 15px;">
                            Strong retention: 73% of Studio members reorder within 30 days
                        </p>
                    </div>
                </div>
            </div>

            <!-- Sidebar Metrics -->
            <div class="sidebar-metrics">
                <!-- Top Performing Dealers -->
                <div class="chart-section">
                    <div class="chart-header">
                        <h3 class="chart-title">Top Studio Members</h3>
                    </div>
                    <div class="chart-content" style="height: auto; padding: 20px;">
                        <div class="dealer-list">
                            <div class="dealer-item">
                                <div class="dealer-info">
                                    <div class="dealer-name">Café Luna</div>
                                    <div class="dealer-location">Sea Point, Cape Town</div>
                                </div>
                                <div class="dealer-stats">
                                    <div class="dealer-revenue">R124K</div>
                                    <div class="dealer-orders">18 orders</div>
                                </div>
                            </div>
                            
                            <div class="dealer-item">
                                <div class="dealer-info">
                                    <div class="dealer-name">The Collective</div>
                                    <div class="dealer-location">Maboneng, JHB</div>
                                </div>
                                <div class="dealer-stats">
                                    <div class="dealer-revenue">R98K</div>
                                    <div class="dealer-orders">14 orders</div>
                                </div>
                            </div>
                            
                            <div class="dealer-item">
                                <div class="dealer-info">
                                    <div class="dealer-name">Rooftop Lounge</div>
                                    <div class="dealer-location">Camps Bay</div>
                                </div>
                                <div class="dealer-stats">
                                    <div class="dealer-revenue">R87K</div>
                                    <div class="dealer-orders">12 orders</div>
                                </div>
                            </div>
                            
                            <div class="dealer-item">
                                <div class="dealer-info">
                                    <div class="dealer-name">Studio 7</div>
                                    <div class="dealer-location">Sandton</div>
                                </div>
                                <div class="dealer-stats">
                                    <div class="dealer-revenue">R76K</div>
                                    <div class="dealer-orders">11 orders</div>
                                </div>
                            </div>
                            
                            <div class="dealer-item">
                                <div class="dealer-info">
                                    <div class="dealer-name">Garden Route Cannabis</div>
                                    <div class="dealer-location">Knysna</div>
                                </div>
                                <div class="dealer-stats">
                                    <div class="dealer-revenue">R65K</div>
                                    <div class="dealer-orders">9 orders</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Product Performance -->
                <div class="chart-section">
                    <div class="chart-header">
                        <h3 class="chart-title">Product Performance</h3>
                    </div>
                    <div class="chart-content" style="height: auto; padding: 20px;">
                        <div class="product-performance">
                            <div class="product-item top">
                                <div>
                                    <div class="product-name">King Size Collection</div>
                                </div>
                                <div class="product-metrics">
                                    <div class="product-units">847 units</div>
                                    <div class="product-revenue">R38K revenue</div>
                                </div>
                            </div>
                            
                            <div class="product-item">
                                <div>
                                    <div class="product-name">Venture Box</div>
                                </div>
                                <div class="product-metrics">
                                    <div class="product-units">67 units</div>
                                    <div class="product-revenue">R42K revenue</div>
                                </div>
                            </div>
                            
                            <div class="product-item">
                                <div>
                                    <div class="product-name">Club Display Kit</div>
                                </div>
                                <div class="product-metrics">
                                    <div class="product-units">23 units</div>
                                    <div class="product-revenue">R28K revenue</div>
                                </div>
                            </div>
                            
                            <div class="product-item">
                                <div>
                                    <div class="product-name">Premium Matches</div>
                                </div>
                                <div class="product-metrics">
                                    <div class="product-units">156 units</div>
                                    <div class="product-revenue">R23K revenue</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Insights -->
                <div class="insights-feed">
                    <div class="chart-header">
                        <h3 class="chart-title">AI Insights</h3>
                    </div>
                    
                    <div class="insight-item">
                        <div class="insight-icon">🔥</div>
                        <div class="insight-content">
                            <div class="insight-title">Hot Opportunity</div>
                            <div class="insight-description">
                                Durban shows 40% growth. Consider regional Studio event or exclusive drop.
                            </div>
                            <div class="insight-time">2 hours ago</div>
                        </div>
                    </div>
                    
                    <div class="insight-item">
                        <div class="insight-icon">📈</div>
                        <div class="insight-content">
                            <div class="insight-title">Trend Alert</div>
                            <div class="insight-description">
                                Co-branding uptake increased 65%. Expand custom packaging options.
                            </div>
                            <div class="insight-time">4 hours ago</div>
                        </div>
                    </div>
                    
                    <div class="insight-item">
                        <div class="insight-icon">⚠️</div>
                        <div class="insight-content">
                            <div class="insight-title">Delivery Alert</div>
                            <div class="insight-description">
                                94% delivery success rate down from 96%. Check Courier Guy performance.
                            </div>
                            <div class="insight-time">6 hours ago</div>
                        </div>
                    </div>
                    
                    <div class="insight-item">
                        <div class="insight-icon">💎</div>
                        <div class="insight-content">
                            <div class="insight-title">Member Milestone</div>
                            <div class="insight-description">
                                Café Luna hit R100K+ orders. Recommend VIP Studio tier upgrade.
                            </div>
                            <div class="insight-time">8 hours ago</div>
                        </div>
                    </div>
                    
                    <div class="insight-item">
                        <div class="insight-icon">🌟</div>
                        <div class="insight-content">
                            <div class="insight-title">Quality Score</div>
                            <div class="insight-description">
                                Average order rating 4.8/5. Premium positioning strategy working.
                            </div>
                            <div class="insight-time">12 hours ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Export Controls -->
        <div class="export-controls">
            <button class="export-btn">Export Revenue Data</button>
            <button class="export-btn">Download Member List</button>
            <button class="export-btn">Performance Report</button>
            <button class="export-btn">Geographic Analysis</button>
        </div>
    </main>

    <script>
        // Time filter functionality
        document.querySelectorAll('.time-filter').forEach(filter => {
            filter.addEventListener('click', function() {
                // Remove active class from all filters
                document.querySelectorAll('.time-filter').forEach(f => f.classList.remove('active'));
                
                // Add active class to clicked filter
                this.classList.add('active');
                
                // Simulate data refresh
                refreshDashboardData(this.textContent);
            });
        });

        // Chart filter functionality
        document.querySelectorAll('.chart-filter').forEach(filter => {
            filter.addEventListener('change', function() {
                const chartSection = this.closest('.chart-section');
                const chartTitle = chartSection.querySelector('.chart-title').textContent;
                refreshChartData(chartTitle, this.value);
            });
        });

        // Export functionality
        document.querySelectorAll('.export-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const exportType = this.textContent.toLowerCase();
                exportData(exportType);
            });
        });

        // Real-time data updates
        function refreshDashboardData(period) {
            // Simulate API call to refresh data
            console.log(`Refreshing data for ${period}`);
            
            // Update KPIs with loading state
            const kpiValues = document.querySelectorAll('.kpi-value');
            kpiValues.forEach(value => {
                value.style.opacity = '0.5';
                setTimeout(() => {
                    value.style.opacity = '1';
                    // Simulate new data
                    if (value.textContent.includes('R')) {
                        const currentValue = parseInt(value.textContent.replace(/[R,K]/g, ''));
                        const newValue = Math.floor(currentValue * (0.9 + Math.random() * 0.2));
                        value.textContent = `R${newValue}K`;
                    }
                }, 500);
            });
            
            updateLastUpdated();
        }

        function refreshChartData(chartTitle, filterValue) {
            console.log(`Refreshing ${chartTitle} with filter: ${filterValue}`);
            // In production, this would fetch filtered data from API
        }

        function exportData(exportType) {
            // Simulate data export
            const timestamp = new Date().toISOString().slice(0, 10);
            
            switch(exportType) {
                case 'export revenue data':
                    alert(`Exporting revenue data...\n\nFile: sleeks-revenue-${timestamp}.csv\nRecords: 1,247 transactions\nSize: 89KB`);
                    break;
                case 'download member list':
                    alert(`Exporting Studio member list...\n\nFile: studio-members-${timestamp}.csv\nRecords: 47 active members\nSize: 12KB`);
                    break;
                case 'performance report':
                    alert(`Generating performance report...\n\nFile: studio-performance-${timestamp}.pdf\nPages: 12\nIncludes: Revenue, Member growth, Geographic analysis`);
                    break;
                case 'geographic analysis':
                    alert(`Exporting geographic data...\n\nFile: geographic-analysis-${timestamp}.csv\nRecords: 12 cities\nMetrics: Orders, Revenue, Growth rates`);
                    break;
            }
        }

        function updateLastUpdated() {
            const lastUpdatedElement = document.querySelector('.last-updated');
            const now = new Date();
            const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            lastUpdatedElement.textContent = `Last updated: Just now • Live data`;
        }

        // Simulate real-time updates
        setInterval(() => {
            // Random KPI updates
            if (Math.random() > 0.95) {
                const revenueKPI = document.querySelector('.kpi-value');
                const currentRevenue = parseInt(revenueKPI.textContent.replace(/[R,K]/g, ''));
                const newRevenue = currentRevenue + Math.floor(Math.random() * 10);
                revenueKPI.textContent = `R${newRevenue}K`;
                
                updateLastUpdated();
            }
            
            // Random new insights
            if (Math.random() > 0.98) {
                addNewInsight();
            }
        }, 10000);

        function addNewInsight() {
            const insights = [
                {
                    icon: '📊',
                    title: 'Order Spike',
                    description: 'Unusual activity detected in Stellenbosch. 3 new orders in last hour.',
                    time: 'Just now'
                },
                {
                    icon: '🎯',
                    title: 'Conversion Alert',
                    description: 'Studio access conversion rate up 15% today. Current campaigns performing well.',
                    time: 'Just now'
                },
                {
                    icon: '🚀',
                    title: 'Growth Milestone',
                    description: 'Monthly revenue target 85% achieved with 6 days remaining.',
                    time: 'Just now'
                }
            ];
            
            const randomInsight = insights[Math.floor(Math.random() * insights.length)];
            const insightsFeed = document.querySelector('.insights-feed');
            const firstInsight = insightsFeed.querySelector('.insight-item');
            
            const newInsight = document.createElement('div');
            newInsight.className = 'insight-item';
            newInsight.style.opacity = '0';
            newInsight.innerHTML = `
                <div class="insight-icon">${randomInsight.icon}</div>
                <div class="insight-content">
                    <div class="insight-title">${randomInsight.title}</div>
                    <div class="insight-description">${randomInsight.description}</div>
                    <div class="insight-time">${randomInsight.time}</div>
                </div>
            `;
            
            insightsFeed.insertBefore(newInsight, firstInsight);
            
            // Animate in
            setTimeout(() => {
                newInsight.style.transition = 'opacity 0.5s ease';
                newInsight.style.opacity = '1';
            }, 100);
            
            // Remove last insight to maintain list length
            const insights_items = insightsFeed.querySelectorAll('.insight-item');
            if (insights_items.length > 5) {
                insights_items[insights_items.length - 1].remove();
            }
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Set initial update time
            updateLastUpdated();
            
            // Simulate loading states
            setTimeout(() => {
                document.querySelectorAll('.chart-placeholder').forEach(placeholder => {
                    placeholder.style.opacity = '0.8';
                });
            }, 1000);
            
            // Initialize tooltips for KPI cards
            document.querySelectorAll('.kpi-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px)';
                    this.style.transition = 'transform 0.3s ease';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });
        });

        // Advanced analytics functions
        function calculateChurnRisk() {
            // Identify Studio members at risk of churning
            const riskFactors = {
                'no_orders_30_days': 0.6,
                'declining_order_value': 0.3,
                'support_tickets': 0.1
            };
            
            // In production, this would analyze actual member behavior
            return riskFactors;
        }

        function predictGrowthOpportunities() {
            // Machine learning insights for growth
            const opportunities = [
                {
                    type: 'geographic_expansion',
                    location: 'Durban',
                    confidence: 0.85,
                    potential_revenue: 'R150K/month'
                },
                {
                    type: 'product_bundle',
                    products: ['Venture Box', 'Premium Matches'],
                    confidence: 0.73,
                    potential_uplift: '18%'
                }
            ];
            
            return opportunities;
        }

        function generateAutomatedReports() {
            // Auto-generate weekly/monthly reports
            const reportData = {
                weekly_summary: {
                    revenue_growth: '+23%',
                    new_members: 8,
                    top_performer: 'Café Luna',
                    insights: 3
                }
            };
            
            return reportData;
        }

        // Webhook simulation for real-time events
        function simulateWebhookEvents() {
            const events = [
                'new_studio_member',
                'large_order_placed',
                'delivery_issue',
                'positive_feedback',
                'referral_success'
            ];
            
            setInterval(() => {
                if (Math.random() > 0.97) {
                    const event = events[Math.floor(Math.random() * events.length)];
                    handleWebhookEvent(event);
                }
            }, 15000);
        }

        function handleWebhookEvent(eventType) {
            switch(eventType) {
                case 'new_studio_member':
                    // Update member count
                    const memberCount = document.querySelector('.kpi-card.growth .kpi-value');
                    const currentCount = parseInt(memberCount.textContent);
                    memberCount.textContent = currentCount + 1;
                    
                    addNewInsight({
                        icon: '🎉',
                        title: 'New Studio Member',
                        description: 'Welcome to the newest Studio member from Pretoria!',
                        time: 'Just now'
                    });
                    break;
                    
                case 'large_order_placed':
                    addNewInsight({
                        icon: '💰',
                        title: 'Large Order Alert',
                        description: 'R45K order placed by The Collective. Automatic priority processing applied.',
                        time: 'Just now'
                    });
                    break;
            }
        }

        // Initialize real-time monitoring
        simulateWebhookEvents();